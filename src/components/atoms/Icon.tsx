import React from 'react'
import styled from 'styled-components'
import { Link } from '@picast-app/router'
import { useTheme } from 'hooks'
import { Button } from './Button'

type Props = {
  icon: keyof typeof icons
  style?: keyof SvgIcon
  linkTo?: string
  onClick?(e: React.MouseEvent<HTMLElement, MouseEvent>): void
  label?: string
  autoFocus?: boolean
  tabIndex?: number
  ripple?: boolean
}

export const Icon: React.FC<Props> = ({
  icon,
  style,
  linkTo,
  onClick,
  label,
  autoFocus,
  tabIndex,
  children,
  ripple = false,
  ...props
}) => {
  const theme = useTheme()
  const svg = (
    <S.Icon viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" {...props}>
      {icons[icon][style ?? (theme === 'dark' ? 'outlined' : 'filled')] ??
        icons[icon].filled}
      {children}
    </S.Icon>
  )
  if (linkTo)
    return (
      <Link to={linkTo} onClick={onClick} className="icon-wrap">
        {svg}
      </Link>
    )
  if (onClick)
    return (
      <Button
        iconWrap={label}
        onClick={onClick}
        {...{ autoFocus, tabIndex }}
        feedback={ripple}
      >
        {svg}
      </Button>
    )
  return svg
}

const S = {
  Icon: styled.svg`
    width: var(--icon-size);
    height: var(--icon-size);
    fill: var(--cl-icon);
  `,
}

const icons = buildSvgPaths({
  library:
    'M4 8h4V4H4v4zm6 12h4v-4h-4v4zm-6 0h4v-4H4v4zm0-6h4v-4H4v4zm6 0h4v-4h-4v4zm6-10v4h4V4h-4zm-6 4h4V4h-4v4zm6 6h4v-4h-4v4zm0 6h4v-4h-4v4z',
  subscriptions: {
    filled:
      'M20 8H4V6h16v2zm-2-6H6v2h12V2zm4 10v8c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2v-8c0-1.1.9-2 2-2h16c1.1 0 2 .9 2 2zm-6 4l-6-3.27v6.53L16 16z',
    outlined:
      'M4 6h16v2H4zm2-4h12v2H6zm14 8H4c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm0 10H4v-8h16v8zm-10-7.27v6.53L16 16z',
  },
  person: {
    filled:
      'M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z',
    outlined:
      'M12 6c1.1 0 2 .9 2 2s-.9 2-2 2-2-.9-2-2 .9-2 2-2m0 10c2.7 0 5.8 1.29 6 2H6c.23-.72 3.31-2 6-2m0-12C9.79 4 8 5.79 8 8s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 10c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z',
  },
  search:
    'M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z',
  arrow_back: 'M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z',
  arrow_down: 'M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6 1.41-1.41z',
  arrow:
    'M18.3,14.29L18.3,14.29c-0.39-0.39-1.02-0.39-1.41,0L13,18.17V3c0-0.55-0.45-1-1-1h0c-0.55,0-1,0.45-1,1v15.18l-3.88-3.88 c-0.39-0.39-1.02-0.39-1.41,0l0,0c-0.39,0.39-0.39,1.02,0,1.41l5.59,5.59c0.39,0.39,1.02,0.39,1.41,0l5.59-5.59 C18.68,15.32,18.68,14.68,18.3,14.29z',
  cancel:
    'M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z',
  expand_more: 'M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z',
  expand_less: 'M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z',
  play: 'M8 6.82v10.36c0 .79.87 1.27 1.54.84l8.14-5.18c.62-.39.62-1.29 0-1.69L9.54 5.98C8.87 5.55 8 6.03 8 6.82z',
  pause:
    'M8 19c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2v10c0 1.1.9 2 2 2zm6-12v10c0 1.1.9 2 2 2s2-.9 2-2V7c0-1.1-.9-2-2-2s-2 .9-2 2z',
  skip: 'M18.9201 12.9999C18.4201 12.9999 18.0101 13.3699 17.9401 13.8599C17.4601 17.2299 14.1701 19.6999 10.5201 18.8199C8.27012 18.2799 6.61012 16.5499 6.13012 14.2899C5.32012 10.4199 8.27012 6.99994 12.0001 6.99994V9.78994C12.0001 10.2399 12.5401 10.4599 12.8501 10.1399L16.6401 6.34994C16.8401 6.14994 16.8401 5.83994 16.6401 5.63994L12.8501 1.84994C12.5401 1.53994 12.0001 1.75994 12.0001 2.20994V4.99994C7.06012 4.99994 3.16012 9.47994 4.16012 14.5999C4.76012 17.7099 7.06012 20.0999 10.1501 20.7899C14.9801 21.8699 19.3001 18.5899 19.9201 14.1199C20.0101 13.5299 19.5201 12.9999 18.9201 12.9999Z',
  more: 'M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z',
  palette:
    'M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z',
  gear: 'M19.14,12.94c0.04-0.3,0.06-0.61,0.06-0.94c0-0.32-0.02-0.64-0.07-0.94l2.03-1.58c0.18-0.14,0.23-0.41,0.12-0.61 l-1.92-3.32c-0.12-0.22-0.37-0.29-0.59-0.22l-2.39,0.96c-0.5-0.38-1.03-0.7-1.62-0.94L14.4,2.81c-0.04-0.24-0.24-0.41-0.48-0.41 h-3.84c-0.24,0-0.43,0.17-0.47,0.41L9.25,5.35C8.66,5.59,8.12,5.92,7.63,6.29L5.24,5.33c-0.22-0.08-0.47,0-0.59,0.22L2.74,8.87 C2.62,9.08,2.66,9.34,2.86,9.48l2.03,1.58C4.84,11.36,4.8,11.69,4.8,12s0.02,0.64,0.07,0.94l-2.03,1.58 c-0.18,0.14-0.23,0.41-0.12,0.61l1.92,3.32c0.12,0.22,0.37,0.29,0.59,0.22l2.39-0.96c0.5,0.38,1.03,0.7,1.62,0.94l0.36,2.54 c0.05,0.24,0.24,0.41,0.48,0.41h3.84c0.24,0,0.44-0.17,0.47-0.41l0.36-2.54c0.59-0.24,1.13-0.56,1.62-0.94l2.39,0.96 c0.22,0.08,0.47,0,0.59-0.22l1.92-3.32c0.12-0.22,0.07-0.47-0.12-0.61L19.14,12.94z M12,15.6c-1.98,0-3.6-1.62-3.6-3.6 s1.62-3.6,3.6-3.6s3.6,1.62,3.6,3.6S13.98,15.6,12,15.6z',
  bell: 'M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z',
  bell_inactive:
    'M12 22c1.1 0 2-.9 2-2h-4c0 1.1.9 2 2 2zm6-6v-5c0-3.07-1.63-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2zm-2 1H8v-6c0-2.48 1.51-4.5 4-4.5s4 2.02 4 4.5v6z',
  bell_active:
    'M7.58 4.08L6.15 2.65C3.75 4.48 2.17 7.3 2.03 10.5h2c.15-2.65 1.51-4.97 3.55-6.42zm12.39 6.42h2c-.15-3.2-1.73-6.02-4.12-7.85l-1.42 1.43c2.02 1.45 3.39 3.77 3.54 6.42zM18 11c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2v-5zm-6 11c.14 0 .27-.01.4-.04.65-.14 1.18-.58 1.44-1.18.1-.24.15-.5.15-.78h-4c.01 1.1.9 2 2.01 2z',
  info: 'M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 15c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1zm1-8h-2V7h2v2z',
  bug: 'M19 8h-1.81c-.45-.78-1.07-1.45-1.82-1.96l.93-.93c.39-.39.39-1.02 0-1.41-.39-.39-1.02-.39-1.41 0l-1.47 1.47C12.96 5.06 12.49 5 12 5s-.96.06-1.41.17L9.11 3.7c-.39-.39-1.02-.39-1.41 0-.39.39-.39 1.02 0 1.41l.92.93C7.88 6.55 7.26 7.22 6.81 8H5c-.55 0-1 .45-1 1s.45 1 1 1h1.09c-.05.33-.09.66-.09 1v1H5c-.55 0-1 .45-1 1s.45 1 1 1h1v1c0 .34.04.67.09 1H5c-.55 0-1 .45-1 1s.45 1 1 1h1.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H19c.55 0 1-.45 1-1s-.45-1-1-1h-1.09c.05-.33.09-.66.09-1v-1h1c.55 0 1-.45 1-1s-.45-1-1-1h-1v-1c0-.34-.04-.67-.09-1H19c.55 0 1-.45 1-1s-.45-1-1-1zm-6 8h-2c-.55 0-1-.45-1-1s.45-1 1-1h2c.55 0 1 .45 1 1s-.45 1-1 1zm0-4h-2c-.55 0-1-.45-1-1s.45-1 1-1h2c.55 0 1 .45 1 1s-.45 1-1 1z',
  storage:
    'M4,20h16c1.1,0,2-0.9,2-2l0,0c0-1.1-0.9-2-2-2H4c-1.1,0-2,0.9-2,2l0,0C2,19.1,2.9,20,4,20z M4,17h2v2H4V17z M2,6L2,6 c0,1.1,0.9,2,2,2h16c1.1,0,2-0.9,2-2l0,0c0-1.1-0.9-2-2-2H4C2.9,4,2,4.9,2,6z M6,7H4V5h2V7z M4,14h16c1.1,0,2-0.9,2-2l0,0 c0-1.1-0.9-2-2-2H4c-1.1,0-2,0.9-2,2l0,0C2,13.1,2.9,14,4,14z M4,11h2v2H4V11z',
  maximize:
    'M6,14L6,14c-0.55,0-1,0.45-1,1v3c0,0.55,0.45,1,1,1h3c0.55,0,1-0.45,1-1l0,0c0-0.55-0.45-1-1-1H7v-2 C7,14.45,6.55,14,6,14z M6,10L6,10c0.55,0,1-0.45,1-1V7h2c0.55,0,1-0.45,1-1l0,0c0-0.55-0.45-1-1-1H6C5.45,5,5,5.45,5,6v3 C5,9.55,5.45,10,6,10z M17,17h-2c-0.55,0-1,0.45-1,1l0,0c0,0.55,0.45,1,1,1h3c0.55,0,1-0.45,1-1v-3c0-0.55-0.45-1-1-1l0,0 c-0.55,0-1,0.45-1,1V17z M14,6L14,6c0,0.55,0.45,1,1,1h2v2c0,0.55,0.45,1,1,1l0,0c0.55,0,1-0.45,1-1V6c0-0.55-0.45-1-1-1h-3 C14.45,5,14,5.45,14,6z',
  minimize:
    'M6,16h2v2c0,0.55,0.45,1,1,1l0,0c0.55,0,1-0.45,1-1v-3c0-0.55-0.45-1-1-1H6c-0.55,0-1,0.45-1,1l0,0C5,15.55,5.45,16,6,16 z M8,8H6C5.45,8,5,8.45,5,9l0,0c0,0.55,0.45,1,1,1h3c0.55,0,1-0.45,1-1V6c0-0.55-0.45-1-1-1l0,0C8.45,5,8,5.45,8,6V8z M15,19 L15,19c0.55,0,1-0.45,1-1v-2h2c0.55,0,1-0.45,1-1l0,0c0-0.55-0.45-1-1-1h-3c-0.55,0-1,0.45-1,1v3C14,18.55,14.45,19,15,19z M16,8 V6c0-0.55-0.45-1-1-1l0,0c-0.55,0-1,0.45-1,1v3c0,0.55,0.45,1,1,1h3c0.55,0,1-0.45,1-1l0,0c0-0.55-0.45-1-1-1H16z',
  list: 'M4,13c0.55,0,1-0.45,1-1s-0.45-1-1-1s-1,0.45-1,1S3.45,13,4,13z M4,17c0.55,0,1-0.45,1-1s-0.45-1-1-1s-1,0.45-1,1 C3,16.55,3.45,17,4,17z M4,9c0.55,0,1-0.45,1-1S4.55,7,4,7S3,7.45,3,8S3.45,9,4,9z M8,13h12c0.55,0,1-0.45,1-1s-0.45-1-1-1H8 c-0.55,0-1,0.45-1,1S7.45,13,8,13z M8,17h12c0.55,0,1-0.45,1-1s-0.45-1-1-1H8c-0.55,0-1,0.45-1,1C7,16.55,7.45,17,8,17z M7,8 c0,0.55,0.45,1,1,1h12c0.55,0,1-0.45,1-1s-0.45-1-1-1H8C7.45,7,7,7.45,7,8z M4,13c0.55,0,1-0.45,1-1s-0.45-1-1-1s-1,0.45-1,1 S3.45,13,4,13z M4,17c0.55,0,1-0.45,1-1s-0.45-1-1-1s-1,0.45-1,1C3,16.55,3.45,17,4,17z M4,9c0.55,0,1-0.45,1-1S4.55,7,4,7 S3,7.45,3,8S3.45,9,4,9z M8,13h12c0.55,0,1-0.45,1-1s-0.45-1-1-1H8c-0.55,0-1,0.45-1,1S7.45,13,8,13z M8,17h12c0.55,0,1-0.45,1-1 s-0.45-1-1-1H8c-0.55,0-1,0.45-1,1C7,16.55,7.45,17,8,17z M7,8c0,0.55,0.45,1,1,1h12c0.55,0,1-0.45,1-1s-0.45-1-1-1H8 C7.45,7,7,7.45,7,8z',
  visible:
    'M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z',
  not_visible:
    'M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z',
  speaker:
    'M3 10v4c0 .55.45 1 1 1h3l3.29 3.29c.63.63 1.71.18 1.71-.71V6.41c0-.89-1.08-1.34-1.71-.71L7 9H4c-.55 0-1 .45-1 1zm13.5 2c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 4.45v.2c0 .38.25.71.6.85C17.18 6.53 19 9.06 19 12s-1.82 5.47-4.4 6.5c-.36.14-.6.47-.6.85v.2c0 .63.63 1.07 1.21.85C18.6 19.11 21 15.84 21 12s-2.4-7.11-5.79-8.4c-.58-.23-1.21.22-1.21.85z',
  google: (
    <g>
      <path
        d="M23.52 12.2729C23.52 11.422 23.4436 10.6038 23.3018 9.81836H12V14.4602H18.4582C18.18 15.9602 17.3345 17.2311 16.0636 18.082V21.0929H19.9418C22.2109 19.0038 23.52 15.9274 23.52 12.2729Z"
        fill="#4285F4"
      />
      <path
        d="M11.9995 23.9998C15.2395 23.9998 17.9559 22.9252 19.9413 21.0925L16.0632 18.0816C14.9886 18.8016 13.6141 19.2271 11.9995 19.2271C8.87406 19.2271 6.22861 17.1161 5.28497 14.2798H1.27588V17.3889C3.25042 21.3107 7.30861 23.9998 11.9995 23.9998Z"
        fill="#34A853"
      />
      <path
        d="M5.28545 14.2799C5.04545 13.5599 4.90909 12.7908 4.90909 11.9999C4.90909 11.209 5.04545 10.4399 5.28545 9.71993V6.61084H1.27636C0.463636 8.23084 0 10.0636 0 11.9999C0 13.9363 0.463636 15.769 1.27636 17.389L5.28545 14.2799Z"
        fill="#FBBC05"
      />
      <path
        d="M11.9995 4.77273C13.7613 4.77273 15.3432 5.37818 16.5868 6.56727L20.0286 3.12545C17.9504 1.18909 15.2341 0 11.9995 0C7.30861 0 3.25042 2.68909 1.27588 6.61091L5.28497 9.72C6.22861 6.88364 8.87406 4.77273 11.9995 4.77273Z"
        fill="#EA4335"
      />
    </g>
  ),
})

type SvgIcon<T = JSX.Element> = {
  filled: T
  outlined?: T
}

function buildSvgPaths<
  T extends { [k: string]: string | SvgIcon<string> | JSX.Element }
>(paths: T): { [k in keyof T]: SvgIcon } {
  return Object.fromEntries(
    Object.entries(paths).map(([k, v]) => [
      k,
      Object.fromEntries(
        Object.entries(
          typeof v === 'string' || !('filled' in v) ? { filled: v } : v
        ).map(([k, v]) => [k, typeof v === 'string' ? <path d={v} /> : v])
      ) as SvgIcon,
    ])
  ) as { [k in keyof T]: SvgIcon }
}
